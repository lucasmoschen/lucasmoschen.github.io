<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Optimal Control Theory | Lucas M. Moschen</title> <meta name="author" content="Lucas Machado Moschen"> <meta name="description" content="Theme of my Scientific Initiation based on the book of S. Lenhart and J. Workman. It was developed a reference text in portuguese and notebooks with applications in the topics."> <meta property="og:site_name" content="Lucas M. Moschen"> <meta property="og:type" content="website"> <meta property="og:title" content="Lucas M. Moschen | Optimal Control Theory"> <meta property="og:url" content="https://lucasmoschen.github.io/projects/2019-optimal_control_book/"> <meta property="og:description" content="Theme of my Scientific Initiation based on the book of S. Lenhart and J. Workman. It was developed a reference text in portuguese and notebooks with applications in the topics."> <meta property="og:locale" content="en"> <meta name="twitter:card" content="summary"> <meta name="twitter:title" content="Optimal Control Theory"> <meta name="twitter:description" content="Theme of my Scientific Initiation based on the book of S. Lenhart and J. Workman. It was developed a reference text in portuguese and notebooks with applications in the topics."> <script type="application/ld+json">
      {
        "author":
        {
          "@type": "Person",
          "name": "Lucas Machado Moschen"
        },
        "url": "https://lucasmoschen.github.io/projects/2019-optimal_control_book/",
        "@type": "WebSite",
        "description": "Theme of my Scientific Initiation based on the book of S. Lenhart and J. Workman. It was developed a reference text in portuguese and notebooks with applications in the topics.",
        "headline": "Optimal Control Theory",
        "sameAs": ["https://orcid.org/0009-0003-3453-553X", "https://scholar.google.com/citations?user=tzj0CYgAAAAJ", "https://www.researchgate.net/profile/Lucas-Moschen", "https://github.com/lucasmoschen", "https://www.linkedin.com/in/lucas-machado-moschen"],
        "name": "Lucas Machado Moschen",
        "@context": "https://schema.org"
      }
    </script> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%91%A8%F0%9F%8F%BB%E2%80%8D%F0%9F%94%AC&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://lucasmoschen.github.io/projects/2019-optimal_control_book/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> <style>*{box-sizing:border-box}.column{float:left;width:50%;padding:5px}.row::after{content:"";clear:both;display:table}</style> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Lucas M. Moschen</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/talks/">Talks</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Optimal Control Theory</h1> <p class="post-description">Theme of my Scientific Initiation based on the book of S. Lenhart and J. Workman. It was developed a reference text in portuguese and notebooks with applications in the topics.</p> </header> <article> <h2 id="about-the-project">About The Project</h2> <p>The objective of this project is to introduce the basic concepts of Optimum Control: existence of solution, Pontryagin Maximum Principle and Dynamic Programming Principle. We intend to study different formulations of a control problem, examples of problems in real life, specially with biologic applications, and basic theoretical results. The main reference of the the project was the book written by Suzanne Lenhart and John T. Workman called <a href="https://www.routledge.com/Optimal-Control-Applied-to-Biological-Models/Lenhart-Workman/p/book/9781584886402#:~:text=Optimal%20Control%20Applied%20to%20Biological%20Models%20thoroughly%20develops%20the%20mathematical,this%20theory%20to%20biological%20models.&amp;text=In%20addition%2C%20the%20authors%20introduce,partial%20differential%20equations%20(PDEs)." rel="external nofollow noopener" target="_blank">Optimal Control Applied to Biological Models</a>.</p> <p>I could understand problems with an optimization process, when one can control a system with some variable. For example, in the Coronavirus Pandemic, we have a system that describes the infected, susceptible and recovered. However, the governments can interfere this system establishing a <em>lockdown</em> or starting an immunization.</p> <p>Notes were produced on the subject in book form written in portuguese language, in order to serve as a reference in this language to start the studies in this topic.</p> <p><a href="https://github.com/lucasmoschen/Optimal_Control_Biological/blob/master/notes/book.pdf" rel="external nofollow noopener" target="_blank">[Download the book here]</a></p> <p>It was also developed in notebooks all the laboratories studied in these notes. For these simulations, <em>Python Programming Language</em> associated with <em>Jupyter Notebook</em> was used, because of its easy usage and simple interpretation. A class in <code class="language-plaintext highlighter-rouge">optimal_control_class.py</code> file was designed to deal with all laboratories, no need to worry with the code, initially. This code contains the famous method in the area called <strong>forward-backward sweep</strong>.</p> <p><a href="https://github.com/lucasmoschen/optimal-control-biological" rel="external nofollow noopener" target="_blank">[The repository can be found here]</a></p> <h2 id="usage">Usage</h2> <h3 id="notebooks">Notebooks</h3> <p>After having the frameworks and python packages, it’s necessary to open <code class="language-plaintext highlighter-rouge">jupyter lab</code> or <code class="language-plaintext highlighter-rouge">jupyter notebook</code>. In the <code class="language-plaintext highlighter-rouge">notebooks</code> folder, one can look at the Laboratories. Each laboratory is self contained, if the theory is well known. The first notebook explains the algorithm forward-backward sweep.</p> <ul> <li>Laboratory 1: Introductory example;</li> <li>Laboratory 2: Mold and fungicide;</li> <li>Laboratory 3: Bacteria;</li> <li>Laboratory 4: Limited case;</li> <li>Laboratory 5: Cancer and treatment;</li> <li>Laboratory 6: Fish harvesting;</li> <li>Laboratory 7: Epidemic model;</li> <li>Laboratory 8: HIV treatment;</li> <li>Laboratory 9: Bear population;</li> <li>Laboratory 10: Glucose model;</li> <li>Laboratory 11: Timber harvesting;</li> <li>Laboratory 12: Bioreactor;</li> <li>Laboratory 13: Predator-Prey model.</li> </ul> <p>After opening each notebook, it’s easy to follow the guide.</p> <h3 id="python-class">Python class</h3> <p>If one have a optimal control problem, it can be used the Python class developed for your case. This function can handle problems with:</p> <ul> <li>Initial conditions of the states (obliged);</li> <li>A characterization of the control in order to update it each iteration, that is, write \(u = f(t, x, \lambda)\) (obliged);</li> <li>Linear payoff terms (optional);</li> <li>Bounds in the control (optional);</li> <li>One or several states.</li> </ul> <p>After one calculate the Hamiltonian and the necessary conditions, it’s necessary:</p> <ul> <li>Differential equations for the states (if more than one state or control, the functions must return an object <code class="language-plaintext highlighter-rouge">numpy.array</code>);</li> <li>Differential equations for the adjoint functions;</li> <li>A characterization of the control: it can handle simple Bang-Bang problems (chapter 11) and problems with bounds;</li> <li>Number of states and controls (optional);</li> </ul> <p>For example, in the Laboratory 8, we first define these variables</p> <p><img src="/assets/images/example-1.png" alt="example1"></p> <p>Because we have more than one state, we specify <code class="language-plaintext highlighter-rouge">n_states = 3</code>. We also specify the bounds. The bounds must be specified as a list of tuples for each control and <code class="language-plaintext highlighter-rouge">numpy.inf</code> is a possibility. However, the control’s characterization must be written including the bounds as specified in the example. If one have a linear payoff term, it can be specified as a function:</p> <p><code class="language-plaintext highlighter-rouge">diff_phi = lambda x, params: np.array([C, D, E])</code>.</p> <p>Observe that the parameters must be passed as a dictionary, including in the functions. At last, we define the final time and initial condition and use it in the <code class="language-plaintext highlighter-rouge">solve</code> method.</p> <p><img src="/assets/images/example-2.png" alt="example2"></p> <p>If one has a Bang-Bang problem, the characterization of u is given by</p> <p><code class="language-plaintext highlighter-rouge">u = lambda t, x, lambda, params: a if psi(t) &lt; 0 else b</code></p> <p>Suppose we have a nonlinear payoff term or we define a final value for some state, in these cases, we do not have the final value for the adjoint corresponding to the state with that additional condition. In this case, the adapted forward-backward sweep must be used. It’s not developed for so, but can be used in the following manner: one define the list <code class="language-plaintext highlighter-rouge">free_adj_final</code> with the adjoints with that characteristic. Associated with that, one make a guess passing it in <code class="language-plaintext highlighter-rouge">theta_list</code> parameter. For more details, consult the notebook</p> <p><code class="language-plaintext highlighter-rouge">Chapter21-examples.ipynb</code>.</p> <h2 id="acknowledgements">Acknowledgements</h2> <ul> <li><a href="https://emap.fgv.br" rel="external nofollow noopener" target="_blank">School of Applied Mathematics (EMAp)</a></li> <li><a href="https://www.gov.br/cnpq/pt-br" rel="external nofollow noopener" target="_blank">Conselho Nacional de Desenvolvimento Científico e Tecnológico (CNPq)</a></li> <li><a href="https://www.gov.br/capes/pt-br" rel="external nofollow noopener" target="_blank">Coordenação de Aperfeiçoamento de Pessoal de Nível Superior (CAPES)</a></li> </ul> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Lucas Machado Moschen. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: March 20, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>